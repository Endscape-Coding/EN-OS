# ======================
# EN-OS - GRUB2 Configuration
# Midnight Ocean Theme
# ======================

### Load essential modules
insmod all_video
insmod gfxterm
insmod png
insmod font

### Set graphical mode
if loadfont "${prefix}/fonts/unicode.pf2"; then
  set gfxmode=auto
  set gfxpayload=keep
  terminal_output gfxterm
fi

### Ocean Color Theme
set color_normal=light-blue/black
set color_highlight=white/dark-blue
set menu_color_normal=light-cyan/black
set menu_color_highlight=white/dark-purple
set menu_color_selected=white/light-blue
set menu_color_title=light-purple/black
set menu_color_disabled=gray/black

### Gradient Background (requires proper theme setup)
if background_image "${prefix}/theme/ocean_gradient.png"; then
  set theme=yes
else
  # Fallback colors if no background image
  set bg_color=000022
  set fg_color=9db4ff
fi

### Platform detection
if [ "${grub_platform}" = 'efi' ]; then
  set bootmode="UEFI"
  set arch_label="x64"
else
  set bootmode="BIOS"
  set arch_label="%ARCH%"
fi

### Main menu configuration
set default="en-os-standard"
set timeout=5
set timeout_style=hidden
set menu_border_color=0044cc
set menu_highlight_color=00aaff

### Menu entries with stylish classes
menuentry " EN-OS Live Environment " --class os --id en-os-standard {
  set gfxpayload=keep
  linux /%INSTALL_DIR%/boot/%ARCH%/vmlinuz-linux archisobasedir=%INSTALL_DIR% quiet splash
  initrd /%INSTALL_DIR%/boot/%ARCH%/initramfs-linux.img
}

menuentry " Safe Graphics Mode " --class recovery {
  set gfxpayload=keep
  linux /%INSTALL_DIR%/boot/%ARCH%/vmlinuz-linux archisobasedir=%INSTALL_DIR% nomodeset
  initrd /%INSTALL_DIR%/boot/%ARCH%/initramfs-linux.img
}

submenu " Advanced Options " --class advanced {
  menuentry " Debug Mode " --class debug {
    linux /%INSTALL_DIR%/boot/%ARCH%/vmlinuz-linux archisobasedir=%INSTALL_DIR% debug
    initrd /%INSTALL_DIR%/boot/%ARCH%/initramfs-linux.img
  }

  menuentry " Memory Test " --class memtest {
    linux /boot/memtest86+/memtest
  }
}

menuentry " System Settings " --class settings {
  submenu " Firmware " --class firmware {
    menuentry " UEFI Settings " --class efi {
      fwsetup
    }
    menuentry " Reboot " --class reboot {
      reboot
    }
  }
}

### Visual enhancements
set pager=1
set menu_margin=20
set item_spacing=5
set menu_width=60
set menu_height=30
set menu_border_width=2

### Custom theme elements
set title_font="unicode"
set title_color="light-purple"
set title_text="EN-OS Boot Menu"
set message_color="light-blue"
set message_bg_color=000033

### Final touch
echo
echo " Loading EN-OS with Midnight Ocean theme..."
play 440 1 523 1 587 1 659 1
